package dtos;

import java.sql.Connection;  
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

import conexionesDB.AdministradorDeConexiones;
import daos.CiudadDAO;
import entidades.Ciudad;


public class CiudadDTO implements CiudadDAO{
	private static Connection conn;
	
	@Override
	public boolean insertar(Integer idpais, Ciudad ciudad) {
		try {
			conn = AdministradorDeConexiones.obtenerConexion();
			String sql = "insert into ciudades (idpais, descripcion) values(?, ?)";
			PreparedStatement ps = conn.prepareStatement(sql);
			ps.setInt(1, idpais);
			ps.setString(2, ciudad.getDescripcion());
			ps.executeUpdate();
			System.out.println("La ciudad \"" + ciudad.getDescripcion() + "\" fue agregaada a la base de datos.");
			return true;
		}catch(Exception e) {
			System.out.println("No se pudo agregar la ciudad \"" + ciudad.getDescripcion() + "\" a la base de datos.");
			System.out.println(e.getMessage());
			e.printStackTrace();
		}
		return false;
	}

	@Override
	public boolean existe(Integer id) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean existe(String descripcion) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public Ciudad buscar(Integer id) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public List<Ciudad> buscar(String descripcion, Integer idpais) {
		List<Ciudad> ciudades = new ArrayList<Ciudad>();
		try {
			conn = AdministradorDeConexiones.obtenerConexion();
			String sql = "select * from ciudades where idpais = ?";
			PreparedStatement ps = conn.prepareStatement(sql);
			//ps.setString(1, "'%" + descripcion + "%'");
			ps.setInt(1, idpais);
			ResultSet rs = ps.executeQuery(sql);
			while (rs.next()) {
				ciudades.add(new Ciudad(rs.getInt("idciudad"), rs.getString("descripcion")));
			}
			return ciudades;
		}catch(Exception e) {
			System.out.println(e.getMessage());
			e.printStackTrace();
		}
		return null;
	}

	@Override
	public boolean eliminar(Integer id) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean modificar(Integer id, String descripcion) {
		// TODO Auto-generated method stub
		return false;
	}

}
